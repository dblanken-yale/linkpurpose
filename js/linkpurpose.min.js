class LinkPurpose{constructor(o){const e={domain:!(LinkPurpose.version="dev"),roots:"body",shadowComponents:!1,ignore:"",noRunIfPresent:!1,noRunIfAbsent:!1,base:{selector:"a[href]",linkClass:"link-purpose",iconWrapperClass:"link-purpose-icon",noBreakClass:"link-purpose-nobreak"},external:{selector:"[href^='/'], [href^='.'], [href^='#']",message:"(Link is external)",linkClass:"link-purpose-external",iconWrapperClass:"link-purpose-external-icon",iconType:"html",iconHTML:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path fill="currentColor" d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h240q17 0 28.5 11.5T480-800q0 17-11.5 28.5T440-760H200v560h560v-240q0-17 11.5-28.5T800-480q17 0 28.5 11.5T840-440v240q0 33-23.5 56.5T760-120H200Zm560-584L416-360q-11 11-28 11t-28-11q-11-11-11-28t11-28l344-344H600q-17 0-28.5-11.5T560-800q0-17 11.5-28.5T600-840h240v240q0 17-11.5 28.5T800-560q-17 0-28.5-11.5T760-600v-104Z"/></svg>',iconSRC:!1,iconClasses:["fa-solid","fa-up-right-from-square"]},document:{selector:"[href$='.pdf'], [href*='.pdf?'], [href$='.doc'], [href$='.docx'], [href*='.doc?'], [href*='.docx?'], [href$='.ppt'], [href$='.pptx'], [href*='.ppt?'], [href*='.pptx?'], [href^='https://docs.google']",message:"(Link opens document)",linkClass:"link-purpose-document",iconWrapperClass:"link-purpose-document-icon",iconType:"html",iconHTML:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path fill="currentColor" d="M360-240h240q17 0 28.5-11.5T640-280q0-17-11.5-28.5T600-320H360q-17 0-28.5 11.5T320-280q0 17 11.5 28.5T360-240Zm0-160h240q17 0 28.5-11.5T640-440q0-17-11.5-28.5T600-480H360q-17 0-28.5 11.5T320-440q0 17 11.5 28.5T360-400ZM240-80q-33 0-56.5-23.5T160-160v-640q0-33 23.5-56.5T240-880h287q16 0 30.5 6t25.5 17l194 194q11 11 17 25.5t6 30.5v447q0 33-23.5 56.5T720-80H240Zm280-560v-160H240v640h480v-440H560q-17 0-28.5-11.5T520-640ZM240-800v200-200 640-640Z"/></svg>',iconSRC:!1,iconClasses:["fa-regular","fa-file-lines"]},mailTo:{selector:'[href^="mailto:"]',message:"(Link sends Email)",linkClass:"link-purpose-mailto",iconWrapperClass:"link-purpose-mail-icon",iconType:"html",iconHTML:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path fill="currentColor" d="M160-160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800h640q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160Zm320-280L160-640v400h640v-400L480-440Zm0-80 320-200H160l320 200ZM160-640v-80 480-400Z"/></svg>',iconURL:!1,iconClasses:["fa-regular","fa-envelope"]},newWindow:{selector:'[target="_blank"]',message:"(Link opens in new window)",linkClass:"link-purpose-window",iconWrapperClass:"link-purpose-window-icon",iconType:"html",iconHTML:'<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path fill="currentColor" d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h200q17 0 28.5 11.5T440-800q0 17-11.5 28.5T400-760H200v560h560v-200q0-17 11.5-28.5T800-440q17 0 28.5 11.5T840-400v200q0 33-23.5 56.5T760-120H200Zm440-520h-80q-17 0-28.5-11.5T520-680q0-17 11.5-28.5T560-720h80v-80q0-17 11.5-28.5T680-840q17 0 28.5 11.5T720-800v80h80q17 0 28.5 11.5T840-680q0 17-11.5 28.5T800-640h-80v80q0 17-11.5 28.5T680-520q-17 0-28.5-11.5T640-560v-80Z"/></svg>',iconURL:!1,iconClasses:["fa-regular","fa-window-restore"]}};var n;n=()=>{LinkPurpose.options={...e,...o},LinkPurpose.links=[],LinkPurpose.sortedLinks=[],LinkPurpose.ignore=LinkPurpose.options.ignore?`:not(${LinkPurpose.options.ignore}, ${LinkPurpose.options.base.linkClass})`:`:not(${LinkPurpose.options.base.linkClass})`,LinkPurpose.run()},"complete"===document.readyState?n():window.addEventListener("load",n),LinkPurpose.findLinks=function(){if(LinkPurpose.links=[],LinkPurpose.noRun=!(!LinkPurpose.options.noRunIfAbsent||null!==document.querySelector(`:is(${LinkPurpose.options.noRunIfAbsent})`)),!LinkPurpose.noRun&&LinkPurpose.options.noRunIfPresent&&(LinkPurpose.noRun=null!==document.querySelector(`:is(${LinkPurpose.options.noRunIfPresent})`)),!LinkPurpose.noRun){var o=LinkPurpose.options.shadowComponents?", "+LinkPurpose.options.shadowComponents:"";const s=`:is(${LinkPurpose.options.base.selector}${o})`+LinkPurpose.options.ignore;o=document.querySelectorAll(LinkPurpose.options.roots);if(o&&(o.forEach(o=>{LinkPurpose.links=LinkPurpose.links.concat(Array.from(o.querySelectorAll(s)))}),LinkPurpose.options.shadowComponents)){var e,n=`:is(${LinkPurpose.options.base.selector})`+LinkPurpose.options.ignore;for(let o=LinkPurpose.links.length-1;0<=o;o--)LinkPurpose.links[o].matches(LinkPurpose.options.shadowComponents)&&("object"==typeof(e=LinkPurpose.links[o].shadowRoot?.querySelectorAll(n))&&0<e.length?LinkPurpose.links.splice(o,1,...e):(console.warn("Link Purpose: A specified shadow host has no shadowRoot."),LinkPurpose.links.splice(o,1)))}}},LinkPurpose.processLinks=function(){if(LinkPurpose.marks=[],LinkPurpose.links){let n=LinkPurpose.options.external.selector;LinkPurpose.options.domain&&(n=n?n+(", "+LinkPurpose.options.domain):LinkPurpose.options.domain),LinkPurpose.links.forEach(o=>{let e=[];LinkPurpose.options.document.selector&&o.matches(`:is(${LinkPurpose.options.document.selector})`)?e=["document"]:LinkPurpose.options.mailTo.selector&&o.matches(`:is(${LinkPurpose.options.mailTo.selector})`)?e=["mailTo"]:n&&o.matches(`:is([href^=http]):not(${n})`)&&(e=["external"]),LinkPurpose.options.newWindow.selector&&o.matches(LinkPurpose.options.newWindow.selector)&&e.push("newWindow"),0!==e.length&&LinkPurpose.marks.push({link:o,hits:e})})}},LinkPurpose.markLinks=function(){LinkPurpose.marks&&LinkPurpose.marks.forEach(a=>{a.hits.forEach((i,t)=>{if(a.link.classList.add(LinkPurpose.options.base.linkClass,LinkPurpose.options[i].linkClass),console.log(i),0===t){let o=a.link.lastChild,e=!1,n=a.link;for(;o;)if(o.lastChild)o=(n=o).lastChild;else{if("#text"!==o.nodeName||!n.lastElementChild||0!==o.textContent.trim().length)break;e=o,n=n.lastElementChild,o=n.lastChild}let s=a.link;var r;o&&"#text"===o.nodeName&&0<o.textContent.length&&null!==(p=(t=o.textContent).match(/\S+\s*$/g))&&((r=document.createElement("span")).classList.add(LinkPurpose.options.base.noBreakClass),r.textContent=p[0],e&&(r.append(e.textContent),e.textContent=""),o.textContent=t.substring(0,t.length-p[0].length),o.parentNode.append(r),s=r);const l=document.createElement("span");l.classList.add(LinkPurpose.options.base.iconWrapperClass,LinkPurpose.options[i].iconWrapperClass),"html"===LinkPurpose.options[i].iconType?l.innerHTML=LinkPurpose.options[i].iconHTML:"classes"===LinkPurpose.options[i].iconType?(console.log("classes!"),LinkPurpose.options[i].iconClasses.forEach(o=>{l.classList.add(o)})):"src"===LinkPurpose.options[i].iconType&&document.createElement("img").setAttribute("src",LinkPurpose.options[i].iconSRC);t=document.createElement("span");t.classList.add("link-purpose-text"),t.textContent=LinkPurpose.options[i].message,l.append(t),s.append(l)}else{var p=a.link.querySelector(".link-purpose-text");p.classList.add(LinkPurpose.options[i].iconWrapperClass),p.textContent=p.textContent+LinkPurpose.options[i].message}})})},LinkPurpose.run=()=>{LinkPurpose.findLinks(),LinkPurpose.processLinks(),LinkPurpose.markLinks()}}}